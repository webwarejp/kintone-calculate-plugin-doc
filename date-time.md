# カテゴリ: 日付と時刻関数

注：ここでのシリアル値は Microsoft Excel と同等です。1900 年 1 月 1 日はシリアル値 が 1 、2008 年 1 月 1 日は 1900 年 1 月 1 日から 39,447 日後に当たるので、シリアル値は 39448 になります。

## DATE 関数

特定の日付を表す シリアル値を返します。

### 書式

    DATE(年,月,日)

| 引数       | 説明         |
|:-----------|:------------|
|年      |必須。年を表す 4 桁の数値を指定します。|
|月      |必須。月を表す 1 ～ 12 の数値を指定します。|
|日      |必須。日を表す 1 ～ 31 数値を指定します。|

## DATESTRING 関数

シリアル値を日付の文字列に変換します。
フォーマットは YY-MM-DD 固定です。UTCには変換しません。

### 書式

    DATESTRING(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付を表すシリアル値を指定します。|


## DATEVALUE 関数

文字列として格納された日付をシリアル値に変換します。 

### 書式

    DATEVALUE(日付文字列)

| 引数       | 説明         |
|:-----------|:------------|
|日付文字列   |必須。日付を表す文字列、または日付タイプのフィールドコードを指定します。|

## DAY 関数

日付の日情報を返します。日情報は 1 ～ 31 の範囲内の整数で示されます。

### 書式

    DAY(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付を表すシリアル値を指定します。|

* 引数には`2010/1/1`という日付を表す文字列、日付タイプのフィールドコードの指定もできます。

## DAYS 関数

2 つの日付間の日数を返します。

### 書式

    DAYS(終了日, 開始日)

| 引数       | 説明         |
|:-----------|:------------|
|終了日      |必須。日付を表す文字列、シリアル値、または日付タイプのフィールドコードを指定します。|
|開始日      |必須。日付を表す文字列、シリアル値、または日付タイプのフィールドコードを指定します。|

## DAYS360 関数

一部の会計計算に使用される 1 年 360 日 (30 日×12 か月) の計算方式に基づいて、2 つの日付の間の日数を返します。

### 書式

    DAYS360(開始日,終了日,[方式])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。日付を表す文字列、シリアル値、または日付タイプのフィールドコードを指定します。|
|終了日      |必須。日付を表す文字列、シリアル値、または日付タイプのフィールドコードを指定します。|
|方式        |省略可能。計算に米国方式とヨーロッパ方式のどちらを採用するかを、論理値で指定します。|

**方式**

| 方式       | 定義         |
|:-----------|:------------|
|FALSE または省略|米国 (NASD) 方式。開始日が、ある月の最終日になる場合、同じ月の 30 日として計算が行われます。終了日がある月の最終日になる場合に、開始日が同じ月の 30 日よりも前になる状況では、終了日は翌月の 1 日として計算が行われます。それ以外の場合、終了日は、同じ月の 30 日として計算が行われます。|
|TRUE | ヨーロッパ方式。開始日または終了日が、ある月の 31 日になる場合、同じ月の 30 日として計算が行われます。|

## EDATE 関数

開始日から起算して、指定された月数だけ前または後の日付に対応するシリアル値を返します。

### 書式

    EDATE(開始日, 月)

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|月         |必須。開始日から起算した月数を指定します。 "月" に正の数を指定すると起算日より後の日付を返し、負の数を指定すると起算日より前の日付を返します。|

## EOMONTH 関数

開始日から起算して、指定された月数だけ前または後の月の最終日に対応するシリアル値を返します。

### 書式

    EOMONTH(開始日, 月)

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|月         |必須。開始日から起算した月数を指定します。 "月" に正の数を指定すると起算日より後の日付を返し、負の数を指定すると起算日より前の日付を返します。|

## HOUR 関数

時刻から時間の値を返します。 戻り値は 0 (午前 0 時) ～ 23 (午後 11 時) の範囲の整数となります。

### 書式

    HOUR(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。時刻を表すシリアル値を指定します。|

* 引数には`12:30`という時刻を表す文字列、`2010/2/20 15:24:00`という日時を表す文字列、日付タイプ、時刻タイプ、日時タイプのフィールドコードの指定もできます。

## ISODATESTRING 関数

シリアル値を ISO 8601 の UTC 日付書式に変換します。

### 書式

    ISODATESTRING(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付文字列に変換するシリアル値を指定します。|

## ISOWEEKNUM 関数

指定された日付のその年における ISO 週番号を返します。

### 書式

    ISOWEEKNUM(日付)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付を示す文字列、シリアル値、または日付タイプのフィールドコードを指定します。|

## MINUTE 関数

時刻の分を返します。 戻り値は 0 (分) ～ 59 (分) の範囲の整数となります。

### 書式

    MINUTE(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。時刻を表すシリアル値を指定します。|

* 引数には`12:30`という時刻を表す文字列、`2010/2/20 15:24:00`という日時を表す文字列、日付タイプ、時刻タイプ、日時タイプのフィールドコードの指定もできます。

## MONTH 関数

日付の月を返します。戻り値は 1 (月) ～ 12 (月) の範囲の整数となります。

### 書式

    MONTH(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付を表すシリアル値を指定します。|

* 引数には`2010/1/1`という日付を表す文字列、日付タイプのフィールドコードの指定もできます。

## NETWORKDAYS 関数

開始日から終了日までの期間に含まれる稼動日の日数を返します。 稼働日とは、土曜、日曜、および指定された休日を除く日のことです。

### 書式

    NETWORKDAYS(開始日, 終了日, [休日])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|終了日      |必須。対象期間の最終日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|休日        |省略可能。稼動日数の計算から除外する日付をサブテーブル内の日付タイプのフィールドコード、または日付を示す文字列の配列定数で指定します。|

## NETWORKDAYSINTL 関数

週末の曜日とその日数を示すパラメーターを使用して、2 つの日付の間の稼働日数を返します。 週末および休日として指定した日はすべて、稼働日と見なされません。

### 書式

    NETWORKDAYSINTL(開始日, 終了日, [週末], [休日])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|終了日      |必須。対象期間の最終日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|週末        |省略可能。週末にする曜日 (稼働日と見なされない日) を指定します。 "週末" は、週末を示す週末番号または文字列で指定します。|
|休日        |省略可能。稼動日数の計算から除外する日付をサブテーブル内の日付タイプのフィールドコード、または日付を示す文字列の配列定数で指定します。|

**週末番号**

| 週末番号    | 週末の曜日  |
|:-----------|:------------|
|1 または省略|土曜日と日曜日 |
|2          |日曜日と月曜日 |
|3          |月曜日と火曜日 |
|4          |火曜日と水曜日 |
|5          |水曜日と木曜日 |
|6          |木曜日と金曜日 |
|7          |金曜日と土曜日 |
|11         |日曜日のみ    |
|12         |月曜日のみ    |
|13         |火曜日のみ    |
|14         |水曜日のみ    |
|15         |木曜日のみ    |
|16         |金曜日のみ    |
|17         |土曜日のみ    |

**週末の文字列値**

7 文字で、文字列内の各文字は月曜日から始まる各曜日を表します。 1 は非稼働日を表し、0 は稼働日を表します。 文字列に使用できる文字は、1 および 0 のみです。 1111111 は無効な文字列です。

たとえば、0000011 と指定すると土曜日と日曜日が週末になります。

## NOW 関数

現在を表すシリアル値を返します。

### 書式

    NOW()

引数はありません。

## SECOND 関数

時刻の秒を返します。 戻り値は 0 (秒) ～ 59 (秒) の範囲の整数となります。

### 書式

    SECOND(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。時刻を表すシリアル値を指定します。|

* 引数には`12:30:41`という時刻を表す文字列、`2010/2/20 15:24:20`という日時を表す文字列、日付タイプ、時刻タイプ、日時タイプのフィールドコードの指定もできます。

## TIME 関数

指定した時刻に対応するシリアル値を返します。

### 書式

    TIME(時, 分, 秒)

| 引数       | 説明         |
|:-----------|:------------|
|時   |必須。時を表す数値を指定します。|
|分   |必須。分を表す数値を指定します。|
|秒   |必須。秒を表す数値を指定します。|

## TIMESTRING 関数

シリアル値を時刻の文字列に変換します。
フォーマットは HH:MM:SS 固定です。UTCには変換しません。

### 書式

    TIMESTRING(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。時刻を表すシリアル値を指定します。|

## TIMEVALUE 関数

文字列で表された時刻をシリアル値に変換します。

### 書式

    TIMEVALUE(時刻文字列)

| 引数       | 説明         |
|:-----------|:------------|
|時刻文字列   |必須。 時刻を表す文字列を指定します。|

## TODAY 関数

現在の日付に対応するシリアル値を返します。

### 書式

    TODAY()

引数はありません。

## WEEKDAY 関数

日付に対応する曜日を返します。戻り値は 1 から 7 までの範囲の整数となります。

### 書式

    WEEKDAY(シリアル値,[週の基準])

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。 日付を表すシリアル値を指定します。|
|週の基準    |必須。  戻り値の種類を数値で指定します。|

* 引数のシリアル値には`2010/1/1`という日付を表す文字列、日付タイプのフィールドコードの指定もできます。

**週の基準**

| 週の基準    | 戻り値       |
|:-----------|:------------|
|1 または省略|1 (日曜) ～ 7 (土曜) の範囲の整数 |
|2          |1 (月曜) ～ 7 (日曜) の範囲の整数 |
|3          |0 (月曜) 〜 6 (日曜) の範囲の整数 |
|11         |1 (月曜) ～ 7 (日曜) の範囲の整数 |
|12         |1 (火曜) ～ 7 (月曜) の範囲の整数 |
|13         |1 (水曜) ～ 7 (火曜) の範囲の整数 |
|14         |1 (木曜) ～ 7 (水曜) の範囲の整数 |
|15         |1 (金曜) ～ 7 (木曜) の範囲の整数 |
|16         |1 (土曜) ～ 7 (金曜) の範囲の整数 |
|17         |1 (日曜) ～ 7 (土曜) の範囲の整数 |

## WEEKNUM 関数

特定の日付が第何週目に当たるかを返します。 たとえば、1 月 1 日を含む週がその年の最初の週で、第 1 週になります。
この関数で使用されるシステムには、次の 2 種類があります。

* システム 1 :    1 月 1 日を含む週がその年の最初の週であり、第 1 週です。
* システム 2 :    その年の最初の木曜日を含む週がその年の最初の週であり、第 1 週です。 このシステムは、ヨーロッパ式週番号システムと呼ばれる、ISO 8601 に規定されている方式です。

### 書式

    WEEKNUM(シリアル値,[週の基準])

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。 日付を表すシリアル値を指定します。|
|週の基準    |必須。  戻り値の種類を数値で指定します。|

* 引数のシリアル値には`2010/1/1`という日付を表す文字列、日付タイプのフィールドコードの指定もできます。

**週の基準**

| 週の基準    | 週の始まり | システム |
|:-----------|:----------|:--------|
|1 または省略 |日曜日  |1           |
|2           |月曜日  |1           |
|11          |月曜日  |1           |
|12          |火曜日  |1           |
|13          |水曜日  |1           |
|14          |木曜日  |1           |
|15          |金曜日  |1           |
|16          |土曜日  |1           |
|17          |日曜日  |1           |
|21          |月曜日  |2           |

## WORKDAY 関数

開始日から起算して、指定された稼動日数だけ前または後の日付に対応するシリアル値を返します。 稼動日とは、土曜、日曜、および指定された祝日を除く日のことです。

### 書式

    WORKDAY(開始日, 日数, [休日])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|日数        |必須。開始日から起算して、週末や祭日を除く週日の日数を指定します。 日数に正の数を指定すると、起算日より後の日付となり、負の数を指定すると、起算日より前の日付となります。|
|休日        |省略可能。稼動日数の計算から除外する日付をサブテーブル内の日付タイプのフィールドコード、または日付を示す文字列の配列定数で指定します。|

## WORKDAYINTL 関数

週末パラメーターを使用して、開始日から起算して指定した稼働日数だけ前または後の日付のシリアル値を返します。 週末パラメーターは、週末がどの曜日で、何日間あるかを示します。 週末および休日として指定した日はすべて、稼働日と見なされません。

### 書式

    WORKDAYINTL(開始日, 日数, [週末], [休日])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|日数        |必須。開始日から起算して、週末や祭日を除く週日の日数を指定します。 日数に正の数を指定すると、起算日より後の日付となり、負の数を指定すると、起算日より前の日付となります。|
|週末        |省略可能。週末にする曜日 (稼働日と見なされない日) を指定します。 "週末" は、週末を示す週末番号または文字列で指定します。|
|休日        |省略可能。稼動日数の計算から除外する日付をサブテーブル内の日付タイプのフィールドコード、または日付を示す文字列の配列定数で指定します。|

**週末番号**

| 週末番号    | 週末の曜日  |
|:-----------|:------------|
|1 または省略|土曜日と日曜日 |
|2          |日曜日と月曜日 |
|3          |月曜日と火曜日 |
|4          |火曜日と水曜日 |
|5          |水曜日と木曜日 |
|6          |木曜日と金曜日 |
|7          |金曜日と土曜日 |
|11         |日曜日のみ    |
|12         |月曜日のみ    |
|13         |火曜日のみ    |
|14         |水曜日のみ    |
|15         |木曜日のみ    |
|16         |金曜日のみ    |
|17         |土曜日のみ    |

**週末の文字列値**

7 文字で、文字列内の各文字は月曜日から始まる各曜日を表します。 1 は非稼働日を表し、0 は稼働日を表します。 文字列に使用できる文字は、1 および 0 のみです。 1111111 は無効な文字列です。

たとえば、0000011 と指定すると土曜日と日曜日が週末になります。

## YEAR 関数

日付に対応する年を返します。 戻り値は、1900 (年) ～ 9999 (年) の範囲の整数となります。

### 書式

    YEAR(シリアル値)

| 引数       | 説明         |
|:-----------|:------------|
|シリアル値   |必須。日付を表すシリアル値を指定します。|

* 引数のシリアル値には`2010/1/1`という日付を表す文字列、日付タイプのフィールドコードの指定もできます。

## YEARFRAC 関数

2 つの日付間の期間の数値で表される年の比率を計算します。

### 書式

    YEARFRAC(開始日, 終了日, [基準])

| 引数       | 説明         |
|:-----------|:------------|
|開始日      |必須。起算日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|終了日      |必須。対象期間の最終日を表す日付を文字列、シリアル値、または日付タイプのフィールドコードで指定します。|
|基準        |省略可能。計算に使用する基準日数を示す数値を指定します。|

**基準**

| 基準        | 基準日数 (月/年)  |
|:-----------|:------------|
|0 または省略 |30 日/360 日 (NASD 方式) |
|1           |実際の日数/実際の日数 |
|2           |実際の日数/360 日 |
|3           |実際の日数/365 日 |
|4          |30 日/360 日 (ヨーロッパ方式) |


