# カテゴリ: 文字列関数

## CHAR 関数

数値で指定された文字を返します。

### 書式

    CHAR(数値)

| 引数       | 説明         |
|:-----------|:------------|
|数値        |必須。変換する文字を表す 1 ～ 255 の範囲内の数値を指定します。 文字は、コンピューターで使用されている文字セットから返されます。|

## CODE 関数

テキスト文字列内の先頭文字の数値コードを返します。 返されるコードは、コンピューターで使用されている文字セットに対応します。

### 書式

    CODE(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。先頭文字のコード番号を調べる文字列を指定します。|

## CONCAT 関数

2 つ以上の文字列を 1 つの文字列に結合します。
CONCAT 関数とCONCATENATE 関数の挙動は同じになります。

### 書式

    CONCAT(文字列 1,[文字列 2], ...)
    CONCATENATE(文字列 1,[文字列 2], ...)

| 引数       | 説明         |
|:-----------|:------------|
|値 1        |必須。結合する最初の項目。数値、文字列またはフィールドコードが指定できます。|
|値 2, ...   |省略可能。結合するその他の項目。数値、文字列またはフィールドコードが指定できます。|

* 引数 にはサブテーブル内のフィールドコードも指定できます。

## CONCATENATE 関数

2 つ以上の文字列を 1 つの文字列に結合します。
CONCAT 関数とCONCATENATE 関数の挙動は同じになります。

### 書式

    CONCAT(文字列 1,[文字列 2], ...)
    CONCATENATE(文字列 1,[文字列 2], ...)

| 引数       | 説明         |
|:-----------|:------------|
|値 1        |必須。結合する最初の項目。数値、文字列またはフィールドコードが指定できます。|
|値 2, ...   |省略可能。結合するその他の項目。数値、文字列またはフィールドコードが指定できます。|

* 引数 にはサブテーブル内のフィールドコードも指定できます。

## DOLLAR 関数

数値を文字列形式に変換し、通貨記号を適用します。     
数値を四捨五入し、通貨書式を設定した文字列に変換します。 

### 書式

    DOLLAR(数値, [桁数])
    YEN(数値, [桁数])

| 引数     | 説明         |
|:---------|:------------|
|数値      |必須。数値、数値を含むフィールドコード、または結果が数値になる数式を指定します。|
|桁数      |省略可能。小数点以下の桁数を指定します。 桁数に負の数を指定すると、数値は小数点の左側の指定した桁で四捨五入されます。 桁数を省略すると、2 を指定したと見なされます。|

### 使用例

| 数式             | 説明         | 結果 |
|:----------------|:------------|:-----|
|DOLLAR(1234.567, 2) |小数第 2 位に四捨五入し、通貨書式で表示します。|$1,234.57|
|DOLLAR(1234.567, -2) |100 の位に四捨五入し、通貨書式で表示します。|$1,200|
|DOLLAR(-1234.567, -2) | 100 の位に四捨五入し、通貨書式で表示します。|($1,200)|
|DOLLAR(-0.123, 4) |小数第 4 位まで表示し、通貨書式で表示します。|($0.1230)|

## EXACT 関数

2 つの文字列を比較して、まったく同じである場合は TRUE を、そうでない場合は FALSE を返します。 

### 書式

    EXACT(文字列 1, 文字列 2)

| 引数       | 説明         |
|:-----------|:------------|
|文字列 1    |必須。一方の文字列を指定します。|
|文字列 2    |必須。 もう一方の文字列を指定します。|

## FIND 関数

指定された文字列を他の文字列の中で検索し、その文字列が最初に現れる位置を左端から数え、その番号を返します。大文字と小文字は区別されます。

### 書式

    FIND(検索文字列, 対象, [開始位置])

| 引数       | 説明         |
|:-----------|:------------|
|検索文字列   |必須。検索する文字列を指定します。|
|対象         |必須。検索文字列を含む文字列を指定します。|
|開始位置     |省略可能。検索を開始する位置を指定します。対象の先頭文字から検索を開始するときは 1 を指定します。開始位置を省略すると、1 を指定したと見なされます。|

* 検索文字列にワイルドカード文字を使うことはできません。
* 検索文字列が対象の中で見つからない場合、エラー値 #VALUE! が返されます。
* 開始位置に 0 以下の整数を指定した場合、エラー値 #VALUE! が返されます。
* 開始位置が対象の文字数よりも大きい場合、エラー値 #VALUE! が返されます。
* 検索文字列に空白文字列 ("") を指定した場合、先頭文字と一致したものと見なされ、開始位置に指定した文字番号または 1 が返されます。

## FIXED 関数

指定した桁数に四捨五入し、結果をピリオド (.) とカンマ (,) を使って書式設定した文字列に変換して返します。

### 書式

    FIXED(数値, [桁数], [桁区切り])

| 引数       | 説明         |
|:-----------|:------------|
|数値        |必須。四捨五入して文字列に変換する数値、またはフィールドコードを指定します。|
|桁数         |省略可能。小数点以下の桁数を指定します。省略すると、2 を指定したと見なされます。|
|桁区切り     |省略可能。 返される文字列をカンマ (,) で桁区切りするかどうかを論理値で指定します。TRUE を指定すると、桁区切りは行われません。|

* 桁数に負の数を指定すると、数値は小数点の左側の指定した桁で四捨五入されます。
* 桁区切りに FALSE を指定するか省略すると、カンマで桁区切りされた文字列が返されます。

## LEFT 関数

文字列の先頭から指定された数の文字を返します。

### 書式

    LEFT(文字列, [文字数])

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。取り出す文字を含む文字列、またはフィールドコードを指定します。|
|文字数      |省略可能。取り出す文字数を指定します。省略すると、1 を指定したと見なされます。|

* 文字数が文字列の文字数を超える場合、文字列全体が返されます。

## LEN 関数

文字列の文字数を返します。

### 書式

    LEN(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。文字数またはバイト数を調べる文字列を指定します。 スペースは文字として数えられます。|

## LOWER 関数

文字列に含まれる英大文字をすべて小文字に変換します。

### 書式

    LOWER(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。小文字に変換する文字列を指定します。 それ以外の文字は変換されません。|

## MID 関数

文字列の指定された位置から指定された文字数の文字を返します。

### 書式

    MID(文字列, 開始位置, 文字数)

| 引数       | 説明         |
|:-----------|:------------|
|文字列       |必須。取り出す文字を含む文字列、またはフィールドコードを指定します。|
|開始位置     |必須。 文字列から取り出す先頭文字の位置を数値で指定します。 文字列の先頭文字の位置が 1 になります。|
|文字数      |必須。取り出す文字数を指定します。省略すると、1 を指定したと見なされます。|

* 開始位置が文字列の文字数より大きい場合、空白文字列 ("") が返されます。
* 開始位置が 1 より小さい場合、エラー値 #VALUE! が返されます。
* 文字数に負の数を指定すると、エラー値 #VALUE! が返されます。

## PROPER 関数

英字文字列の単語の先頭の文字、および記号の次の文字を大文字に変換します。 それ以外の英字はすべて小文字にします。

### 書式

    PROPER(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。文字列、戻り値が文字列となる数式、または文字列を含むフィールドコードを指定します。|

## REPLACE 関数

文字列に含まれる、指定された文字数の文字を別の文字に置き換えます。

### 書式

    REPLACE(文字列, 開始位置, 文字数, 置換文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。 置き換えを行う文字列を指定します。|
|開始位置    |必須。置換文字列と置き換える先頭文字の位置 (文字番号) を数値で指定します。文字列の先頭文字の位置が 1 になります。|
|文字数      |必須。置換文字列と置き換える文字列の文字数を指定します。|
|置換文字列  |必須。 文字列の一部と置き換える文字列を指定します。|

## REPT 関数

文字列を指定された回数だけ繰り返して表示します。

### 書式

    REPT(文字列, 繰り返し回数)

| 引数       | 説明         |
|:-----------|:------------|
|文字列       |必須。繰り返す文字列、またはフィールドコードを指定します。|
|繰り返し回数  |必須。文字列を繰り返す回数を、正の数値で指定します。|

* 繰り返し回数に 0 を指定すると、空白文字列 ("") が返されます。
* 繰り返し回数に整数以外の値を指定すると、小数点以下が切り捨てられます。
* REPT 関数で作成される文字列は、32,767 文字までです。これを超える場合は、エラー値 #VALUE! が返されます。

## RIGHT 関数

文字列の末尾 (右端) から指定された文字数の文字を返します。

### 書式

    RIGHT(文字列,[文字数])

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。取り出す文字を含む文字列、またはフィールドコードを指定します。|
|文字数      |省略可能。取り出す文字数 (文字列の末尾からの文字数) を指定します。省略すると、1 を指定したと見なされます。|

## SEARCH 関数

指定された文字列を他の文字列の中で検索し、その文字列が最初に現れる位置を左端から数え、その番号を返します。大文字と小文字は区別されません。

### 書式

    SEARCH(検索文字列,対象,[開始位置])

| 引数       | 説明         |
|:-----------|:------------|
|検索文字列   |必須。検索する文字列を指定します。|
|対象         |必須。検索文字列を含む文字列を指定します。|
|開始位置     |省略可能。検索を開始する位置を指定します。対象の先頭文字から検索を開始するときは 1 を指定します。省略すると、1 を指定したと見なされます。|

* 検索文字列にワイルドカード文字を使うことはできません。
* 検索文字列が対象の中で見つからない場合、エラー値 #VALUE! が返されます。
* 開始位置に 0 以下の整数を指定した場合、エラー値 #VALUE! が返されます。
* 開始位置が対象の文字数よりも大きい場合、エラー値 #VALUE! が返されます。
* 検索文字列に空白文字列 ("") を指定した場合、先頭文字と一致したものと見なされ、開始位置に指定した文字番号または 1 が返されます。

## SUBSTITUTE 関数

文字列中の指定された文字列を他の文字列に置き換えます。 SUBSTITUTE 関数は、文字列中の特定の文字を置き換えるときに使用します。文字列中の特定の位置にある文字を他の文字に置き換えるときは、REPLACE 関数を使用します。

### 書式

    SUBSTITUTE(文字列,検索文字列,置換文字列,[置換対象])

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。置き換えを行う文字列を指定します。|
|検索文字列  |必須。置換する文字列を指定します。|
|置換文字列  |必須。検索文字列を検索して置き換える文字列を指定します。|
|置換対象    |省略可能。 検索文字列に含まれるどの文字列を置換文字列と置き換えるかを指定します。 置換対象を指定した場合、検索文字列中の置換対象文字列だけが置き換えられます。 指定しない場合、検索文字列中のすべての文字列が置換文字列に置き換えられます。|

## TEXTJOIN 関数

複数の範囲や文字列からのテキストを結合し、結合する各テキスト値の間に、指定した区切り記号を挿入します。

### 書式

    TEXTJOIN(区切り記号, ignore_empty, 文字列 1, [文字列 2],...)

| 引数       | 説明         |
|:-----------|:------------|
|区切り記号   |必須。結合する文字列の間に挿入する文字列を指定します。|
|ignore_empty|必須。TRUE の場合、空の文字列は無視されます。|
|文字列 1     |必須。結合する文字列を指定します。|
| [文字列 2],...|(省略可能)。結合する追加の文字列を指定します。|

## TRIM 関数

各単語間のスペースは 1 つ残し、不要なスペースをすべて削除します。

### 書式

    TRIM(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。余分なスペースを削除するテキストを指定します。|

## UPPER 関数

文字列を大文字に変換します。

### 書式

    UPPER(文字列)

| 引数       | 説明         |
|:-----------|:------------|
|文字列      |必須。大文字に変換する文字列を指定します。|


## YEN 関数

数値を文字列形式に変換し、通貨記号を適用します。     
数値を四捨五入し、通貨書式を設定した文字列に変換します。 

### 書式

    DOLLAR(数値, [桁数])
    YEN(数値, [桁数])

| 引数     | 説明         |
|:---------|:------------|
|数値      |必須。数値、数値を含むフィールドコード、または結果が数値になる数式を指定します。|
|桁数      |省略可能。小数点以下の桁数を指定します。 桁数に負の数を指定すると、数値は小数点の左側の指定した桁で四捨五入されます。 桁数を省略すると、2 を指定したと見なされます。|

### 使用例

| 数式             | 説明         | 結果 |
|:----------------|:------------|:-----|
|YEN(1234.567, 2) |小数第 2 位に四捨五入し、通貨書式で表示します。|¥1,234.57|
|YEN(1234.567, -2) |100 の位に四捨五入し、通貨書式で表示します。|¥1,200|
|YEN(-1234.567, -2) | 100 の位に四捨五入し、通貨書式で表示します。|(¥1,200)|
|YEN(-0.123, 4) |小数第 4 位まで表示し、通貨書式で表示します。|(¥0.1230)|
