# kintone 計算プラグイン 計算式ドキュメント

## 本ドキュメントについて

本ドキュメントは https://webware.theshop.jp/ で提供する kintone 計算プラグインで設定できる計算式について記述しています。
kintone 計算プラグインは Excel ライクな **100 種類以上** の関数を使用することが可能で、
JavaScript による独自のカスタマイズなしで様々な計算処理を行うことが可能です。

## 計算式の書式について

* 先頭に = （イコール）は付けないでください。
* 文字列は " （ダブルクォーテーション）で囲んでください。
* 式中の半角スペースは無視されます。（文字列中の半角スペースは除く）
* kintone 上のフィールドを計算式に含める場合、フィールドのフィールドコードを指定します。フィールドコードはダブルクォーテーションなどで囲まず、そのまま記述します。

## 算術演算子

|演算子|説明   |
|:----:|:-----|
| +    | 加算  |
| -    | 減算  |
| /    | 除算  |
| *    | 乗算  |
| %    | 剰余  |
| ^    | べき乗|

## 比較演算子

|演算子|説明  |
|:----:|:-----|
| =    | 左辺と右辺が等しい|
| <>   | 左辺と右辺が等しくない|
| >    | 左辺が右辺よりも大きい|
| <    | 左辺が右辺よりも小さい|
| >=   | 左辺が右辺以上である|
| <=   | 左辺が右辺以下である|

## 文字列連結演算子

|演算子|説明  |
|:----:|:-----|
| &    | 2 つの文字列を連結して 1 つの文字列にします。|

## サポート関数

[カテゴリ別関数一覧](category-list.md)

## テーブル（サブテーブル）について

kintone の フォームパーツの 1 つである「テーブル」は、サブテーブルとも呼ばれ、本書ではサブテーブルと呼称しています。    
サブテーブル内のフィールドは、計算プラグインの内部では配列として扱われます。

計算式を設定するフィールド（結果を入れるフィールド）がサブテーブル内のフィールドの場合、計算式に同一サブテーブル内のフィールドを含めた場合、同一列の値を使用して計算することになります。    
計算式を設定するフィールド（結果を入れるフィールド）がサブテーブル内のフィールドの場合、計算式に異なるサブテーブル内のフィールドを含めた場合、配列として扱われます。

## 配列について

サポート関数にはいくつか配列を引数に持つものがあり、配列定数を指定できるようになっています。
配列定数は、 [Microsoft Excel の配列定数の書式](https://support.office.com/ja-jp/article/%E9%85%8D%E5%88%97%E5%AE%9A%E6%95%B0%E3%82%92%E9%85%8D%E5%88%97%E6%95%B0%E5%BC%8F%E3%81%AE%E4%B8%AD%E3%81%A7%E4%BD%BF%E3%81%86-477443ea-5e71-4242-877d-fcae47454eb8)と同じで以下のような書式になります。

    {1,2,3,4,5}   // 数値の配列定数
    {"a","b","c"} // 文字列の配列定数
    {1,2,3;4,5,6;7,8,9} // 複数行の数値の配列

すべての配列定数は計算プラグインの内部では JavaScript の二次元配列に変換されます。
例えば、上記の最初の配列定数の場合、

    [[1,2,3,4,5]]

になります。
関数によって、上記の二次元配列を一次元配列に変換して扱うものとそのまま二次元配列として扱うものがあります。    
関数の説明にこれに関する注意書きがないものは一次元配列として扱います。    
多くの場合、 , （カンマ）区切りの指定で問題ありません。

## 空のフィールドについて

フィールドが空かどうかを判定するには、 ISBLANK 関数を使用してください。
フィールドを空に設定する場合は、 NULL 関数を使用してください。

